<!DOCTYPE html>

<html lang="pt-br">

<head>
	<title> Armazenamento de dados e Manipulação de arquivos em javaScript </title>
	<meta charset="utf-8">

	<style>
		body {
			font-size: 14px;
		}

		img {
			margin: 10px;
			width: 600px;

		}

		ul,
		li {
			list-style-type: none;
		}
	</style>


</head>



<body>

	<h1>Guardador de arquivos</h1>
	<ul>
		<input type="file" id="arquivo" name="arquivo" onchange="mudarArquivoImagem(this)">

		<li id="resultado" onclick="carregarArquivo(input)"></li>

		<script>

			document.write("<br>");
			for (var i=0; i < localStorage.length; i++) {
				
				var link = document.createElement('a');
				var quebra = document.createElement('br');
				link.href = localStorage[localStorage.key(i)];
				link.innerHTML = "Arquivo ".concat([i+1]);
				resultado.appendChild(quebra);
				resultado.appendChild(link);
				resultado.appendChild(quebra);				
				
		}
		</script>


	</ul>




	<script>



		function mudarArquivoImagem(input) {
			var arquivo = input.files[0];
			var reader = new FileReader();
			reader.onload = carregarArquivo;
			reader.readAsDataURL(arquivo);
		}

		function carregarArquivo(evento) {

			if (evento.target.result.slice(5, 10) === 'image') {
				var imagem = document.createElement("img");
				var quebra = document.createElement('br');
				imagem.src = evento.target.result;
				resultado.appendChild(imagem);
				resultado.appendChild(quebra);

				localStorage.setItem("imagemStorage", toBase64String(imagem));




			} else {
				var link = document.createElement('a');
				var quebra = document.createElement('br');
				link.href = evento.target.result;
				link.innerHTML = "Arquivo ";
				resultado.appendChild(quebra);
				resultado.appendChild(link);
				resultado.appendChild(quebra);

				localStorage.setItem("stringStorage", link);



			}

			function toBase64String(img) {
				var canvas = document.createElement("canvas");
				canvas.width = img.width;
				canvas.height = img.height;
				var ctx = canvas.getContext("2d");
				ctx.drawImage(img, 0, 0);
				var dataURL = canvas.toDataURL("image/png");
				return dataURL;
			}

		}
	</script>

</body>

</html>